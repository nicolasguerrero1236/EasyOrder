<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito de Compras - Bros Burger y Lomos</title>
    <link rel="stylesheet" href="../styles/estilos.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Encabezado -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <img src="../files/logo_bros.jpeg" alt="Logo Bro's" class="logo-img">
                <div class="logo-text">
                    <h1>Bro's Burger y Lomos</h1>
                    <p>Â¡No hacemos comida hacemos quilombo de sabor!</p>
                </div>
            </div>
            <div class="carrito-icon">
                <a href="carrito.html" class="btn-carrito">
                    <i class="fas fa-shopping-cart"></i>
                    <span id="contador-carrito" class="contador">0</span>
                </a>
            </div>
        </div>
    </header>

    <main class="container">
        <div style="margin-bottom: 30px;">
            <h1 style="color: var(--color-primary); margin-bottom: 10px;">ðŸ›’ Tu Carrito de Compras</h1>
        </div>

        <!-- Carrito vacÃ­o -->
        <div id="carrito-vacio" class="carrito-vacio" style="display: none;">
            <i class="fas fa-shopping-cart"></i>
            <h2>Tu carrito estÃ¡ vacÃ­o</h2>
            <p>Â¡AÃ±ade algunos productos para empezar!</p>
            <a href="../index.html" class="btn-primary">Volver al MenÃº</a>
        </div>

        <!-- Carrito con productos -->
        <div id="carrito-contenido" style="display: none;">
            <div class="carrito-container">
                <!-- Tabla de productos -->
                <table class="tabla-carrito">
                    <thead>
                        <tr>
                            <th>Producto</th>
                            <th>Precio Unitario</th>
                            <th>Cantidad</th>
                            <th>Subtotal</th>
                            <th>AcciÃ³n</th>
                        </tr>
                    </thead>
                    <tbody id="tabla-items">
                    </tbody>
                </table>

                <!-- Resumen -->
                <div class="carrito-resumen">
                    <div class="resumen-item">
                        <span>Subtotal:</span>
                        <span id="subtotal">$0.00</span>
                    </div>
                    <div class="resumen-item">
                        <span>EnvÃ­o/Retiro:</span>
                        <span id="envio">$0.00</span>
                    </div>
                    <div class="resumen-item total">
                        <span>TOTAL:</span>
                        <span id="total">$0.00</span>
                    </div>
                </div>

                <!-- Botones de acciÃ³n -->
                <div class="carrito-acciones">
                    <a href="../index.html" class="btn-continuar">
                        <i class="fas fa-arrow-left"></i> Continuar Comprando
                    </a>
                    <button class="btn-vaciar-anim" onclick="vaciarCarrito()" aria-label="Vaciar carrito">
                        <svg viewBox="0 0 448 512" class="vaciar-icon">
                            <path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Formulario de datos -->
            <div style="margin-top: 40px;">
                <div class="formulario-cliente">
                    <h2><i class="fas fa-user"></i> InformaciÃ³n de Contacto</h2>
                    <form onsubmit="enviarPedido(event)">
                        <input type="text" id="nombre" placeholder="Tu nombre completo *" required>
                        <input type="tel" id="telefono" placeholder="Tu telÃ©fono (sin WhatsApp) *" required>
                        <input type="email" id="email" placeholder="Tu email (opcional)">
                        <input type="text" id="direccion" placeholder="DirecciÃ³n de entrega/retiro (opcional)">
                        
                                                <div class="delivery-toggle">
                                                        <div class="checkbox-container">
                                                            <label class="ios-checkbox red">
                                                                <input type="checkbox" id="delivery" onchange="actualizarCarrito()" />
                                                                <div class="checkbox-wrapper">
                                                                    <div class="checkbox-bg"></div>
                                                                    <svg class="checkbox-icon" viewBox="0 0 24 24" fill="none">
                                                                        <path
                                                                            class="check-path"
                                                                            d="M4 12L10 18L20 6"
                                                                            stroke="currentColor"
                                                                            stroke-width="3"
                                                                            stroke-linecap="round"
                                                                            stroke-linejoin="round"
                                                                        ></path>
                                                                    </svg>
                                                                </div>
                                                            </label>
                                                            <span class="checkbox-text">ðŸšš Delivery (+$500)</span>
                                                        </div>
                                                </div>
                        
                        <textarea id="notas" placeholder="Notas especiales (ej: Sin cebolla, sin mayo, etc.)"></textarea>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <button type="button" class="btn-secondary" onclick="document.getElementById('formulario-oculto').style.display='none'">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                            <button type="submit" class="btn-whatsapp">
                                <i class="fab fa-whatsapp"></i> Enviar por WhatsApp
                            </button>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2026 Bros Burger y Lomos. Todos los derechos reservados.</p>
    </footer>

    <script src="../javascript/main.js"></script>
    <script>
        // Actualizar carrito en la pÃ¡gina
        function actualizarCarrito() {
            const items = carrito.obtener();

            if (items.length === 0) {
                document.getElementById('carrito-vacio').style.display = 'block';
                document.getElementById('carrito-contenido').style.display = 'none';
                return;
            }

            document.getElementById('carrito-vacio').style.display = 'none';
            document.getElementById('carrito-contenido').style.display = 'block';

            // Actualizar tabla
            const tabla = document.getElementById('tabla-items');
            tabla.innerHTML = items.map(item => `
                <tr>
                    <td>${item.emoji} ${item.nombre}</td>
                    <td>$${item.precio.toFixed(2)}</td>
                    <td>
                        <div class="cantidad">
                            <button type="button" onclick="disminuirCantidad('${item.id}')" style="width: 30px; padding: 5px; background: #ecf0f1; border: none; cursor: pointer;">-</button>
                            <input type="number" value="${item.cantidad}" min="1" onchange="carrito.actualizar('${item.id}', parseInt(this.value)); actualizarCarrito();" style="width: 60px; text-align: center;">
                            <button type="button" onclick="aumentarCantidad('${item.id}')" style="width: 30px; padding: 5px; background: #ecf0f1; border: none; cursor: pointer;">+</button>
                        </div>
                    </td>
                    <td>$${(item.precio * item.cantidad).toFixed(2)}</td>
                    <td>
                        <button type="button" class="btn-eliminar" onclick="carrito.eliminar('${item.id}'); actualizarCarrito();">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');

            // Actualizar totales
            const subtotal = carrito.getTotal();
            const delivery = document.getElementById('delivery') && document.getElementById('delivery').checked ? 500 : 0;
            const total = subtotal + delivery;
            
            document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('envio').textContent = delivery > 0 ? `$${delivery.toFixed(2)}` : 'Retiro en local';
            document.getElementById('total').textContent = `$${total.toFixed(2)}`;
        }

        // Funciones de cantidad
        function aumentarCantidad(id) {
            const item = carrito.obtener().find(i => i.id === id);
            if (item) {
                carrito.actualizar(id, item.cantidad + 1);
                actualizarCarrito();
            }
        }

        function disminuirCantidad(id) {
            const item = carrito.obtener().find(i => i.id === id);
            if (item && item.cantidad > 1) {
                carrito.actualizar(id, item.cantidad - 1);
                actualizarCarrito();
            }
        }

        // Vaciar carrito
        function vaciarCarrito() {
            if (confirm('Â¿EstÃ¡s seguro de que deseas vaciar el carrito?')) {
                carrito.vaciar();
                actualizarCarrito();
            }
        }

        // Mostrar formulario
        function mostrarFormulario() {
            if (carrito.obtener().length === 0) {
                mostrarAlerta('âš ï¸ Tu carrito estÃ¡ vacÃ­o', 'error');
                return;
            }
            document.querySelector('.formulario-cliente').scrollIntoView({ behavior: 'smooth' });
        }

        // Enviar pedido
        function enviarPedido(event) {
            event.preventDefault();

            const cliente = {
                nombre: document.getElementById('nombre').value,
                telefono: document.getElementById('telefono').value,
                email: document.getElementById('email').value,
                direccion: document.getElementById('direccion').value,
                delivery: document.getElementById('delivery').checked,
                notas: document.getElementById('notas').value
            };

            if (!cliente.nombre || !cliente.telefono) {
                mostrarAlerta('âš ï¸ Por favor completa nombre y telÃ©fono', 'error');
                return;
            }

            if (carrito.obtener().length === 0) {
                mostrarAlerta('âš ï¸ Tu carrito estÃ¡ vacÃ­o', 'error');
                return;
            }

            // Enviar a WhatsApp
            enviarPorWhatsApp(cliente);

            // Limpiar formulario y carrito despuÃ©s de enviar
            setTimeout(() => {
                carrito.vaciar();
                document.querySelector('form').reset();
                actualizarCarrito();
                mostrarAlerta('âœ“ Pedido enviado por WhatsApp. Â¡Gracias por tu compra!', 'exito');
            }, 500);
        }

        // Cargar carrito al iniciar
        document.addEventListener('DOMContentLoaded', actualizarCarrito);
    </script>
</body>
</html>
